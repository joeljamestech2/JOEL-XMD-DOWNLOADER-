<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>JOEL XMD YouTube Downloader</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;500&display=swap" rel="stylesheet" />
<style>
  :root {
    --bg: #0a0a0a;
    --text: #fff;
    --highlight: #00d9ff;
    --radius: 12px;
    --muted: #bbb;
  }
  body {
    margin: 0; padding: 2rem;
    font-family: 'JetBrains Mono', monospace;
    background: var(--bg);
    color: var(--text);
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
  }
  h1 {
    color: var(--highlight);
    margin-bottom: 1rem;
    font-weight: 500;
    text-align: center;
  }
  input[type="text"] {
    width: 100%;
    max-width: 600px;
    padding: 0.7rem;
    border-radius: var(--radius);
    border: none;
    outline: none;
    background: #111;
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
  }
  button {
    margin-top: 1rem;
    padding: 0.7rem 1.5rem;
    background: var(--highlight);
    border: none;
    border-radius: var(--radius);
    font-weight: bold;
    cursor: pointer;
    color: #000;
  }
  #errorMsg {
    color: red;
    margin-top: 1rem;
  }
  #results {
    margin-top: 2rem;
    width: 100%;
    max-width: 720px;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  .video-card {
    background: #111;
    border-radius: var(--radius);
    padding: 1rem;
    box-shadow: 0 0 10px rgba(0, 217, 255, 0.3);
    display: flex;
    gap: 1rem;
    align-items: center;
    transition: transform 0.2s ease;
  }
  .video-card:hover {
    transform: scale(1.02);
  }
  .thumbnail {
    width: 120px;
    height: 67.5px;
    object-fit: cover;
    border-radius: var(--radius);
    flex-shrink: 0;
  }
  .info {
    flex-grow: 1;
    color: var(--text);
  }
  .title {
    font-weight: 700;
    margin: 0 0 0.3rem 0;
    color: var(--highlight);
  }
  .details {
    font-size: 0.85rem;
    color: var(--muted);
  }
  .download-btn {
    background: var(--highlight);
    color: #000;
    padding: 0.5rem 1rem;
    border-radius: var(--radius);
    font-weight: bold;
    text-decoration: none;
    user-select: none;
    margin-left: 0.5rem;
    cursor: pointer;
  }
  .btn-group {
    display: flex;
    gap: 0.5rem;
    flex-shrink: 0;
  }
</style>
</head>
<body>

<h1>JOEL XMD YouTube Downloader</h1>
<input type="text" id="searchInput" placeholder="Search YouTube videos..." />
<button onclick="searchYouTube()">Search</button>

<div id="errorMsg"></div>
<div id="results"></div>

<script>
  async function searchYouTube() {
    const query = document.getElementById('searchInput').value.trim();
    const resultsDiv = document.getElementById('results');
    const errorMsg = document.getElementById('errorMsg');
    resultsDiv.innerHTML = '';
    errorMsg.textContent = '';

    if (!query) {
      errorMsg.textContent = '❌ Please enter a search term.';
      return;
    }

    try {
      // Call the API you provided
      const apiURL = `https://my-rest-apis-six.vercel.app/yts?query=${encodeURIComponent(query)}`;
      const res = await fetch(apiURL);
      const data = await res.json();

      if (data.status !== 'success' || !data.results || data.results.length === 0) {
        throw new Error('No videos found.');
      }

      data.results.forEach(video => {
        const videoCard = document.createElement('div');
        videoCard.className = 'video-card';

        videoCard.innerHTML = `
          <img class="thumbnail" src="${video.thumbnail}" alt="${video.title}" />
          <div class="info">
            <div class="title" title="${video.title}">${video.title}</div>
            <div class="details">Duration: ${video.duration} | Views: ${video.views.toLocaleString()} | Channel: ${video.author}</div>
          </div>
          <div class="btn-group">
            <a href="#" class="download-btn" onclick="downloadAudio(event, '${video.url}')">Download Audio</a>
            <a href="#" class="download-btn" onclick="downloadVideo(event, '${video.url}')">Download Video</a>
          </div>
        `;

        resultsDiv.appendChild(videoCard);
      });

    } catch (err) {
      errorMsg.textContent = '❌ ' + err.message;
    }
  }

  async function downloadAudio(event, videoUrl) {
    event.preventDefault();
    const errorMsg = document.getElementById('errorMsg');
    errorMsg.textContent = 'Please wait, fetching audio link...';

    try {
      const apiUrl = `https://iamtkm.vercel.app/downloaders/ytmp3?url=${encodeURIComponent(videoUrl)}`;
      const res = await fetch(apiUrl);
      const data = await res.json();

      if (!data.status || !data.data || !data.data.url) {
        throw new Error('Failed to get audio download link.');
      }

      const a = document.createElement('a');
      a.href = data.data.url;
      a.download = `${data.data.title}.mp3`;
      a.target = '_blank';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);

      errorMsg.textContent = '';
    } catch (err) {
      errorMsg.textContent = '❌ ' + err.message;
    }
  }

  async function downloadVideo(event, videoUrl) {
    event.preventDefault();
    const errorMsg = document.getElementById('errorMsg');
    errorMsg.textContent = 'Please wait, fetching video link...';

    try {
      const apiUrl = `https://iamtkm.vercel.app/downloaders/ytmp4?url=${encodeURIComponent(videoUrl)}`;
      const res = await fetch(apiUrl);
      const data = await res.json();

      if (!data.status || !data.data || !data.data.url) {
        throw new Error('Failed to get video download link.');
      }

      const a = document.createElement('a');
      a.href = data.data.url;
      a.download = `${data.data.title}.mp4`;
      a.target = '_blank';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);

      errorMsg.textContent = '';
    } catch (err) {
      errorMsg.textContent = '❌ ' + err.message;
    }
  }
</script>

</body>
</html>
